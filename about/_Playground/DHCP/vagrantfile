Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/lunar64"

  # DHCP server configuration
  config.vm.define "dhcp" do |dhcp|
    dhcp.vm.network "private_network", ip: "192.168.33.10"
    dhcp.vm.provision "shell", inline: "apt-get update && apt-get -y install isc-dhcp-server && sed -i 's/INTERFACESv4=\"\"/INTERFACESv4=\"eth1\"/' /etc/default/isc-dhcp-server && cp /etc/dhcp/dhcpd.conf /etc/dhcp/dhcpd.conf.bak && echo 'subnet 192.168.33.0 netmask 255.255.255.0 {\n  range 192.168.33.100 192.168.33.150;\n}' > /etc/dhcp/dhcpd.conf && systemctl restart isc-dhcp-server"
  end

  # DHCP client configuration
  config.vm.define "client" do |client|
    client.vm.network "private_network", type: "dhcp"
    client.vm.provision "shell", inline: "apt-get update && apt-get -y install dhcp-client && dhclient"
  end
end