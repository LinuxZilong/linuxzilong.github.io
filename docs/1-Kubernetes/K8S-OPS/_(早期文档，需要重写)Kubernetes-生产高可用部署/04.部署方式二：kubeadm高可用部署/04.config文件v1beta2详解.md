---
title: 04.config文件v1beta2详解
---



## 前言

官方建议kubeadm 使用 -- config 选项传递 YAML 配置文件，然而YAML 配置文件详尽参数并没有中文介绍，故整理本文。

>注意：目前v1beta1已被弃用，建议使用v1beta2和v1beta3
>
>v1beta2官方文档
>
>https://pkg.go.dev/k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta2
>
>https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/
>
>官方示例：
>
>https://kubernetes.io/zh/docs/setup/production-environment/tools/kubeadm/control-plane-flags/

## 基本知识

配置 kubeadm 的首选方法是使用 -- config 选项传递 YAML 配置文件。Kubeadm 配置文件中定义的一些配置选项也可以作为命令行标志使用，但是这种方法只支持最常见/最简单的用例。

Kubeadm 配置文件可以包含使用三个破折号(“---”)分隔的多个配置类型。

```
apiVersion: kubeadm.k8s.io/v1beta2
kind: InitConfiguration

apiVersion: kubeadm.k8s.io/v1beta2
kind: ClusterConfiguration

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration

apiVersion: kubeproxy.config.k8s.io/v1alpha1
kind: KubeProxyConfiguration

apiVersion: kubeadm.k8s.io/v1beta2
kind: JoinConfiguration
```

要打印“ init”和“ join”操作的默认值，请使用以下命令:

```
kubeadm config print init-defaults
kubeadm config print join-defaults
```

配置文件所需参数取决于您正在执行的操作（init 或 join）以及使用的配置选项。

可以自定义配置文件来覆盖kubeadm默认值，若没有提供配置文件或者只提供了部分参数，kubeadm 将使用默认值；

如果用户提供的配置类型不是您正在执行的操作所预期的，kubeadm 将忽略这些类型并打印警告。

## Kubeadm init

使用 --config 选项执行 kubeadm init 时，可以使用以下配置类型：InitConfiguration、ClusterConfiguration、KubeProxyConfiguration、KubeletConfiguration，但 InitConfiguration 和 ClusterConfiguration 之间只有一种是必需的。

+ InitConfiguration 类型应该用于配置运行时设置，在 kubeadm init 的情况下是引导令牌的配置以及特定于执行 kubeadm 的节点的所有设置，包括：

\- NodeRegistration，保存与将新节点注册到集群相关的字段；使用它来自定义节点名称、要使用的 CRI 套接字或任何其他应仅应用于该节点的设置（例如节点 ip）。

\- LocalAPIEndpoint，表示要部署在该节点上的API服务器实例的端点；使用它例如自定义 API 服务器广告地址。

+ ClusterConfiguration 类型应该用于配置集群范围的设置，包括以下设置：

\- 网络，保存集群网络拓扑的配置；使用它例如自定义 pod 子网或服务子网。

\- 等配置；使用它来定制本地 etcd 或配置 API 服务器以使用外部 etcd 集群。

\- kube-apiserver、kube-scheduler、kube-controller-manager 配置；通过添加自定义设置或覆盖 kubeadm 默认设置，使用它来自定义控制平面组件。

+ KubeProxyConfiguration 类型应该用于更改传递给集群中部署的 kube-proxy 实例的配置。如果未提供或仅部分提供此对象，kubeadm 将应用默认值。

+ KubeletConfiguration 类型应该用于更改将传递给集群中部署的所有 kubelet 实例的配置。如果未提供或仅部分提供此对象，kubeadm 将应用默认值。

这是一个完整的 YAML 文件示例，其中包含要在 `kubeadm init` 运行期间使用的多种配置类型。

```bash
apiVersion: kubeadm.k8s.io/v1beta2
kind: InitConfiguration
bootstrapTokens:
- token: "9a08jv.c0izixklcxtmnze7"
  description: "kubeadm bootstrap token"
  ttl: "24h"
- token: "783bde.3f89s0fje9f38fhf"
  description: "another bootstrap token"
  usages:
  - authentication
  - signing
  groups:
  - system:bootstrappers:kubeadm:default-node-token
nodeRegistration:
  name: "ec2-10-100-0-1"
  criSocket: "/var/run/dockershim.sock"
  taints:
  - key: "kubeadmNode"
    value: "master"
    effect: "NoSchedule"
  kubeletExtraArgs:
    v: 4
  ignorePreflightErrors:
  - IsPrivilegedUser
localAPIEndpoint:
  advertiseAddress: "10.100.0.1"
  bindPort: 6443
certificateKey: "e6a2eb8581237ab72a4f494f30285ec12a9694d750b9785706a83bfcbbbd2204"
---
apiVersion: kubeadm.k8s.io/v1beta2
kind: ClusterConfiguration
etcd:
  # one of local or external
  local:
    imageRepository: "k8s.gcr.io"
    imageTag: "3.2.24"
    dataDir: "/var/lib/etcd"
    extraArgs:
      listen-client-urls: "http://10.100.0.1:2379"
    serverCertSANs:
    -  "ec2-10-100-0-1.compute-1.amazonaws.com"
    peerCertSANs:
    - "10.100.0.1"
  # external:
    # endpoints:
    # - "10.100.0.1:2379"
    # - "10.100.0.2:2379"
    # caFile: "/etcd/kubernetes/pki/etcd/etcd-ca.crt"
    # certFile: "/etcd/kubernetes/pki/etcd/etcd.crt"
    # keyFile: "/etcd/kubernetes/pki/etcd/etcd.key"
networking:
  serviceSubnet: "10.96.0.0/16"
  podSubnet: "10.244.0.0/24"
  dnsDomain: "cluster.local"
kubernetesVersion: "v1.12.0"
controlPlaneEndpoint: "10.100.0.1:6443"
apiServer:
  extraArgs:
    authorization-mode: "Node,RBAC"
  extraVolumes:
  - name: "some-volume"
    hostPath: "/etc/some-path"
    mountPath: "/etc/some-pod-path"
    readOnly: false
    pathType: File
  certSANs:
  - "10.100.1.1"
  - "ec2-10-100-0-1.compute-1.amazonaws.com"
  timeoutForControlPlane: 4m0s
controllerManager:
  extraArgs:
    "node-cidr-mask-size": "20"
  extraVolumes:
  - name: "some-volume"
    hostPath: "/etc/some-path"
    mountPath: "/etc/some-pod-path"
    readOnly: false
    pathType: File
scheduler:
  extraArgs:
    address: "10.100.0.1"
  extraVolumes:
  - name: "some-volume"
    hostPath: "/etc/some-path"
    mountPath: "/etc/some-pod-path"
    readOnly: false
    pathType: File
certificatesDir: "/etc/kubernetes/pki"
imageRepository: "k8s.gcr.io"
useHyperKubeImage: false
clusterName: "example-cluster"
---
apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
# kubelet specific options here
---
apiVersion: kubeproxy.config.k8s.io/v1alpha1
kind: KubeProxyConfiguration
# kube-proxy specific options here
```

## Kubeadm join

使用 --config 选项执行 kubeadm join 时，应提供 JoinConfiguration 类型。

```
apiVersion: kubeadm.k8s.io/v1beta2 
kind: JoinConfiguration 
   ...
```

+ JoinConfiguration 类型应该用于配置运行时设置，在 kubeadm join 的情况下是用于访问集群信息的发现方法以及特定于执行 kubeadm 的节点的所有设置，包括：

\- NodeRegistration，保存与将新节点注册到集群相关的字段；使用它来自定义节点名称、要使用的 CRI 套接字或任何其他应仅应用于该节点的设置（例如节点 ip）。

\- APIEndpoint，表示最终要部署在该节点上的API服务器实例的端点。

## Resource Types 资源类型

## ！`ClusterConfiguration`    

ClusterConfiguration contains cluster-wide configuration for a kubeadm cluster

ClusterConfiguration 包含 kubeadm 集群的集群范围配置

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `apiVersion` string 弦                                       | `kubeadm.k8s.io/v1beta2`                                     |
| `kind` string 弦                                             | `ClusterConfiguration`                                       |
| `etcd` **[Required] [需要]**  [`Etcd`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-Etcd) | `etcd` holds configuration for etcd. “ etcd”保存 etcd 的配置 |
| `networking` **[Required] [需要]**  [`Networking`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-Networking) | `networking` holds configuration for the networking topology of the cluster. “ networking”保存集群的网络拓扑结构的配置 |
| `kubernetesVersion` **[Required] [需要]**  `string`          | `kubernetesVersion` is the target version of the control plane. ‘ kubernetesVersion’是控制平面的目标版本 |
| `controlPlaneEndpoint` **[Required] [需要]**  `string`       | `controlPlaneEndpoint` sets a stable IP address or DNS name for the control plane; it can be a valid IP address or a RFC-1123 DNS subdomain, both with optional TCP port. In case the ControlPlaneEndpoint is not specified, the AdvertiseAddress + BindPort are used; in case the ControlPlaneEndpoint is specified but without a TCP port, the BindPort is used. Possible usages are: “  controlPlaneEndpoint”为控制平面设置一个稳定的 IP 地址或 DNS 名称; 它可以是一个有效的 IP 地址或  RFC-1123 DNS 子域，两者都有可选的 TCP 端口。如果没有指定 ControlPlaneEndpoint，则使用  declarseaddress + BindPort; 如果指定了 ControlPlaneEndpoint，但没有指定 TCP 端口，则使用  BindPort。可能的用途是: In a cluster with more than one control plane instances, this field should be assigned the address of the external load balancer in front of the control plane instances. 在具有多个控制平面实例的集群中，应该将该字段分配给控制平面实例前面的外部负载均衡器的地址 In environments with enforced node recycling, the ControlPlaneEndpoint could be used for assigning a stable DNS to the control plane. 在强制节点回收的环境中，ControlPlaneEndpoint 可用于将稳定的 DNS 分配给控制平面 |
| `apiServer` **[Required] [需要]**  [`APIServer`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-APIServer) | `apiServer` contains extra settings for the API server. ‘ apiServer’包含 API 服务器的额外设置 |
| `controllerManager` **[Required] [需要]**  [`ControlPlaneComponent`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ControlPlaneComponent) | `controllerManager` contains extra settings for the controller manager. “控制器管理器”包含控制器管理器的额外设置 |
| `scheduler` **[Required] [需要]**  [`ControlPlaneComponent`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ControlPlaneComponent) | `scheduler` contains extra settings for the scheduler. ‘ scheduler’包含调度程序的额外设置 |
| `dns` **[Required] [需要]**  [`DNS`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-DNS) | `dns` defines the options for the DNS add-on. “ DNS”定义 DNS 附加组件的选项 |
| `certificatesDir` **[Required] [需要]**  `string`            | `certificatesDir` specifies where to store or look for all required certificates. “ certificatesDir”指定存储或查找所有需要的证书的位置 |
| `imageRepository` **[Required] [需要]**  `string`            | `imageRepository` sets the container registry to pull images from. If empty, `k8s.gcr.io` will be used by default; in case of kubernetes version is a CI build (kubernetes version starts with `ci/` or `ci-cross/`) `gcr.io/k8s-staging-ci-images` will be used as a default for control plane components and for kube-proxy, while `k8s.gcr.io` will be used for all the other images. |
| `useHyperKubeImage` **[Required] [需要]**  `bool`            | `useHyperKubeImage` controls if hyperkube should be used for Kubernetes components instead of their respective separate images DEPRECATED: As hyperkube is itself deprecated, this fields is too. It will be removed in future kubeadm config versions, kubeadm will print multiple warnings when this is set to true, and at some point it may become ignored. 控制是否应该将 hyperkubeimage 用于 Kubernetes 组件，而不是它们各自的已弃用的单独图像: 由于 hyperkube  本身已弃用，这个字段也弃用了。它将在以后的 kubeadm 配置版本中被删除，当设置为 true 时，kubeadm  将打印多个警告，并且在某些情况下它可能会被忽略 |
| `featureGates` **[Required] [需要]**  `map[string]bool`      | Feature gates enabled by the user. 用户启用的特性门          |
| `clusterName` **[Required] [需要]**  `string`                | The cluster name 集群名称                                    |

## ！`ClusterStatus`    

ClusterStatus contains the cluster status. The ClusterStatus will be stored in the kubeadm-config ConfigMap in the cluster, and then updated by kubeadm when additional control plane instance joins or leaves the cluster.

ClusterStatus 包含集群状态。ClusterStatus 将存储在集群中的 kubeadm-config ConfigMap 中，然后在其他控制平面实例加入或离开集群时由 kubeadm 进行更新。

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `apiVersion` string 弦                                       | `kubeadm.k8s.io/v1beta2`                                     |
| `kind` string 弦                                             | `ClusterStatus`                                              |
| `apiEndpoints` **[Required] [需要]**  [`map[string\]github.com/tengqm/kubeconfig/config/kubeadm/v1beta2.APIEndpoint`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-APIEndpoint) | `apiEndpoints` currently available in the cluster, one for each control plane/API server instance. The key of the map is the IP of the host's default interface 集群中目前可用的“ apiEndpoints”，每个控制平面/API 服务器实例都有一个 apiEndpoints。映射的关键是主机默认接口的 IP |

## ！`InitConfiguration`    

InitConfiguration contains a list of elements that is specific "kubeadm init"-only runtime information.

InitConfiguration 包含一个元素列表，该列表只包含特定的“ kubeadm init”运行时信息。

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `apiVersion` string 弦                                       | `kubeadm.k8s.io/v1beta2`                                     |
| `kind` string 弦                                             | `InitConfiguration`                                          |
| `bootstrapTokens` **[Required] [需要]**  [`[\]BootstrapToken`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-BootstrapToken) | `bootstrapTokens` is respected at `kubeadm init` time and describes a set of Bootstrap Tokens to create. This information IS NOT uploaded to the kubeadm cluster configmap, partly because of its sensitive nature ‘ bootstraptraptokens’在‘ kubeadm/init’时代广受推崇，并描述了要创建的一组 Bootstrap token。这些信息没有被上传到 kubeadm 集群的配置图中，部分原因是因为它的敏感性 |
| `nodeRegistration` **[Required] [需要]**  [`NodeRegistrationOptions`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-NodeRegistrationOptions) | `nodeRegistration` holds fields that relate to registering the new control-plane node to the cluster “ noderestration”包含与将新的控制平面节点注册到集群相关的字段 |
| `localAPIEndpoint` **[Required] [需要]**  [`APIEndpoint`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-APIEndpoint) | `localAPIEndpoint` represents the endpoint of the API server instance that's deployed on this control plane node In HA setups, this differs from ClusterConfiguration.ControlPlaneEndpoint in the sense that ControlPlaneEndpoint is the global endpoint for the cluster, which then loadbalances the requests to each individual API server. This configuration object lets you customize what IP/DNS name and port the local API server advertises it's accessible on. By default, kubeadm tries to auto-detect the IP of the default interface and use that, but in case that process fails you may set the desired value here. “ localAPIEndpoint”表示部署在这个控制平面节点上的 API 服务器实例的端点。在 HA 设置中，这不同于  ClusterConfiguration。ControlPlaneEndpoint 指的是 ControlPlaneEndpoint  是集群的全局端点，然后集群将请求加载到每个单独的 API 服务器。这个配置对象允许您自定义 IP/DNS 名称和本地 API  服务器所宣称的可访问的端口。默认情况下，kubeadm 尝试自动检测默认接口的 IP 并使用它，但是如果这个过程失败，您可以在这里设置所需的值 |
| `certificateKey` **[Required] [需要]**  `string`             | `certificateKey` sets the key with which certificates and keys are encrypted prior to being uploaded in a Secret in the cluster during the "uploadcerts" init phase. “ certificateKey”设置密钥，在“ uploadcerts”init 阶段将证书和密钥加密后再上传到集群中的 Secret 中 |

## ！`JoinConfiguration`    

JoinConfiguration contains elements describing a particular node.

JoinConfiguration 包含描述特定节点的元素。

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `apiVersion` string 弦                                       | `kubeadm.k8s.io/v1beta2`                                     |
| `kind` string 弦                                             | `JoinConfiguration`                                          |
| `nodeRegistration` **[Required] [需要]**  [`NodeRegistrationOptions`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-NodeRegistrationOptions) | `nodeRegistration` holds fields that relate to registering the new control-plane node to the cluster “ noderestration”包含与将新的控制平面节点注册到集群相关的字段 |
| `caCertPath` **[Required] [需要]**  `string`                 | `caCertPath` is the path to the SSL certificate authority used to secure comunications between node and control-plane. Defaults to "/etc/kubernetes/pki/ca.crt". |
| `discovery` **[Required] [需要]**  [`Discovery`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-Discovery) | `discovery` specifies the options for the kubelet to use during the TLS Bootstrap process ‘ discovery’指定了 kubelet 在 TLS 引导过程中使用的选项 |
| `controlPlane` **[Required] [需要]**  [`JoinControlPlane`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-JoinControlPlane) | `controlPlane` defines the additional control plane instance to be deployed on the joining node. If nil, no additional control plane instance will be deployed. “ controlPlane”定义要部署在连接节点上的附加控制平面实例。如果为 nil，则不会部署额外的控制平面实例 |

## `APIEndpoint`    

**Appears in:**

出现在:

- [ClusterStatus](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ClusterStatus)

- [InitConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-InitConfiguration)

- [JoinControlPlane](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-JoinControlPlane)

  连接控制面

APIEndpoint struct contains elements of API server instance deployed on a node.

APIEndpoint 结构包含部署在节点上的 API 服务器实例的元素。

| Field 田野调查                                     | Description 描述                                             |
| -------------------------------------------------- | ------------------------------------------------------------ |
| `advertiseAddress` **[Required] [需要]**  `string` | `advertiseAddress` sets the IP address for the API server to advertise. 设置 API 服务器发布广告的 IP 地址 |
| `bindPort` **[Required] [需要]**  `int32`          | `bindPort` sets the secure port for the API Server to bind to. Defaults to 6443. “ bindPort”设置了要绑定到的 API 服务器的安全端口. 默认为6443 |

## `APIServer`    

**Appears in:**

出现在:

- [ClusterConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ClusterConfiguration)

APIServer holds settings necessary for API server deployments in the cluster

APIServer 保存集群中的 API 服务器部署所需的设置

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `ControlPlaneComponent` **[Required] [需要]**  [`ControlPlaneComponent`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ControlPlaneComponent) | (Members of  (委员会成员`ControlPlaneComponent` are embedded into this type.)    都嵌入到这个类型中。)No description provided. 没有提供描述 |
| `certSANs` **[Required] [需要]**  `[]string`                 | `certSANs` sets extra Subject Alternative Names for the API Server signing cert. “ certSANs”为 API 服务器签名证书设置了额外的主题替代名称 |
| `timeoutForControlPlane` **[Required] [需要]**  [`meta/v1.Duration`](https://godoc.org/k8s.io/apimachinery/pkg/apis/meta/v1#Duration) | `timeoutForControlPlane` controls the timeout that we use for API server to appear “ timeoutForControlPlane”控制 API 服务器出现的超时时间 |

## `BootstrapToken`    

**Appears in:**

出现在:

- [InitConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-InitConfiguration)

BootstrapToken describes one bootstrap token, stored as a Secret in the cluster

BootstrapToken 描述了一个引导令牌，作为 Secret 存储在集群中

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `token` **[Required] [需要]**  [`BootstrapTokenString`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-BootstrapTokenString) | `token` used for establishing bidirectional trust between nodes and control-planes. Used for joining nodes in the cluster. “令牌”用于建立节点和控制平面之间的双向信任，用于连接集群中的节点 |
| `description` **[Required] [需要]**  `string`                | `description` sets a human-friendly message why this token exists and what it's used for, so other administrators can know its purpose. “ description”设置了一个人性化的消息，告诉其存在的原因和用途，以便其他管理员能够知道它的用途 |
| `ttl` **[Required] [需要]**  [`meta/v1.Duration`](https://godoc.org/k8s.io/apimachinery/pkg/apis/meta/v1#Duration) | `ttl` defines the time to live for this token. Defaults to "24h". `expires` and `ttl` are mutually exclusive. ‘ ttl’定义此令牌的存活时间。默认值为“24h”。‘ expires’和‘ ttl’互斥 |
| `expires` **[Required] [需要]**  [`meta/v1.Time`](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.21/#time-v1-meta) | `expires` specifies the timestamp when this token expires. Defaults to being set dynamically at runtime based on the `ttl`. `expires` and `ttl` are mutually exclusive. “ expires”指定此令牌过期时的时间戳。默认设置为在运行时基于‘ ttl’动态设置。‘ expires’和‘ ttl’是相互排斥的 |
| `usages` **[Required] [需要]**  `[]string`                   | `usages` describes the ways in which this token can be used. Can by default be used for establishing bidirectional trust, but that can be changed here. “用法”描述了这个标记的使用方式。默认情况下可以用于建立双向信任，但是这里可以更改 |
| `groups` **[Required] [需要]**  `[]string`                   | `groups` specifies the extra groups that this token will authenticate as when/if used for authentication ‘ groups’指定此令牌将被认证为 when/if 用于身份验证的额外组 |

## `BootstrapTokenDiscovery`    

**Appears in:**

出现在:

- [Discovery 发现](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-Discovery)

BootstrapTokenDiscovery is used to set the options for bootstrap token based discovery

使用 bootstrap/kendiscovery 来设置基于 bootstrap 令牌的发现选项

| Field 田野调查                                           | Description 描述                                             |
| -------------------------------------------------------- | ------------------------------------------------------------ |
| `token` **[Required] [需要]**  `string`                  | `token` is a token used to validate cluster information fetched from the control-plane. “ token”是一个令牌，用于验证从控制平面获取的集群信息 |
| `apiServerEndpoint` **[Required] [需要]**  `string`      | `apiServerEndpoint` is an IP or domain name to the API server from which information will be fetched. “ apiServerEndpoint”是 API 服务器的 IP 或域名，将从中获取信息 |
| `caCertHashes` **[Required] [需要]**  `[]string`         | discovery is used. The root CA found during discovery must match one of these values. Specifying an empty set disables root CA pinning, which can be unsafe. Each hash is specified as ` 证据被利用。在发现过程中找到的根 CA 必须匹配这些值中的一个。指定空集将禁用根 CA 钉住，这可能是不安全的。每个散列被指定为‘:`, where the only currently supported type is "sha256". This is a hex-encoded SHA-256 hash of the Subject Public Key Info (SPKI) object in DER-encoded ASN.1. These hashes can be calculated using, for example, OpenSSL. 目前唯一支持的类型是“ sha256”。这是 der 编码 ASN. 1中的 Subject Public Key Info (SPKI)对象的十六进制编码 SHA-256哈希。这些散列可以使用，例如 OpenSSL 来计算 |
| `unsafeSkipCAVerification` **[Required] [需要]**  `bool` | `unsafeSkipCAVerification` allows token-based discovery without CA verification via `caCertHashes`. This can weaken the security of kubeadm since other nodes can impersonate the control-plane. “ unsafeSkipCAVerification”允许通过“ caCertHashes”进行基于标记的发现，而不需要 CA 验证。这会削弱 kubeadm 的安全性，因为其他节点可以模仿控制平面 |

## `BootstrapTokenString`    

**Appears in:**

出现在:

- [BootstrapToken](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-BootstrapToken)

BootstrapTokenString is a token of the format abcdef.abcdef0123456789 that is used for both validation of the practically of the API server from a joining node's point of view and as an authentication method for the node in the bootstrap phase of "kubeadm join". This token is and should be short-lived

BootstrapTokenString 是 abcdef.abcdef0123456789格式的标记，用于从加入节点的角度验证 API 服务器的实用性，并作为“ kubeadm 加入”的引导阶段的节点的身份验证方法。这个标记是并且应该是短暂的

| Field 田野调查                      | Description 描述                      |
| ----------------------------------- | ------------------------------------- |
| `-` **[Required] [需要]**  `string` | No description provided. 没有提供描述 |
| `-` **[Required] [需要]**  `string` | No description provided. 没有提供描述 |

## `ControlPlaneComponent`    

**Appears in:**

出现在:

- [ClusterConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ClusterConfiguration)
- [APIServer](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-APIServer)

ControlPlaneComponent holds settings common to control plane component of the cluster

Controlplancomponent 保存通用于控制集群平面组件的设置

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `extraArgs` **[Required] [需要]**  `map[string]string`       | `extraArgs` is an extra set of flags to pass to the control plane component. 是一组额外的标志，用来传递给控制飞机组件 |
| `extraVolumes` **[Required] [需要]**  [`[\]HostPathMount`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-HostPathMount) | `extraVolumes` is an extra set of host volumes, mounted to the control plane component. 是一组额外的主机卷，安装在控制平面组件上 |

## `DNS`    

**Appears in:**

出现在:

- [ClusterConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ClusterConfiguration)

DNS defines the DNS addon that should be used in the cluster

DNS 定义了应该在集群中使用的 DNS 插件

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `type` **[Required] [需要]**  [`DNSAddOnType`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-DNSAddOnType) | `type` defines the DNS add-on to use. ‘ type’定义要使用的 DNS 附加组件 |
| `ImageMeta` **[Required] [需要]**  [`ImageMeta`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ImageMeta) | (Members of  (委员会成员`ImageMeta` are embedded into this type.)   `imageMeta` allows to customize the image used for the DNS. 可以自定义 DNS 使用的图像 |

## `DNSAddOnType`    

(Alias of `string`)

(字符串的别名)

**Appears in:**

出现在:

- [DNS](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-DNS)

DNSAddOnType defines string identifying DNS add-on types

DNSAddOnType 定义识别 DNS 附加类型的字符串

## `Discovery`    

**Appears in:**

出现在:

- [JoinConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-JoinConfiguration)

Discovery specifies the options for the kubelet to use during the TLS Bootstrap process

Discovery 指定了 kubelet 在 TLS 引导过程中使用的选项

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `bootstrapToken` **[Required] [需要]**  [`BootstrapTokenDiscovery`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-BootstrapTokenDiscovery) | `bootstrapToken` is used to set the options for bootstrap token based discovery. `bootstrapToken` and `file` are mutually exclusive. ‘ bootstrapToken’用于设置基于引导令牌的发现的选项。‘ bootstrapToken’和‘ file’是互斥的 |
| `file` **[Required] [需要]**  [`FileDiscovery`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-FileDiscovery) | `file` specifies a file or URL to a kubeconfig file from which to load cluster information. `bootstrapToken` and `file` are mutually exclusive. ‘ file’指定了一个文件或者一个指向 kubeconfig 文件的 URL，从这个文件中可以加载集群信息。“ bootstrapToken”和“ file”是互斥的 |
| `tlsBootstrapToken` **[Required] [需要]**  `string`          | `tlsBootstrapToken` is a token used for TLS bootstrapping. If `bootstrapToken` is set, this field is defaulted to `bootstrapToken.token`, but can be overridden. If `file` is set, this field ∗∗must be set∗∗ in case the KubeConfigFile does not contain any other authentication information 是一个用于 TLS 引导的令牌。如果设置了“ bootstrapToken”，则此字段默认为“ bootstrapToken.token”，但可以重写。如「档案」已填妥，申请人必须填妥第 x 次/次数，以防「库贝克档案」没有其他认证资料 |
| `timeout` **[Required] [需要]**  [`meta/v1.Duration`](https://godoc.org/k8s.io/apimachinery/pkg/apis/meta/v1#Duration) | `timeout` modifies the discovery timeout. 超时修改了发现超时 |

## `Etcd`    

**Appears in:**

出现在:

- [ClusterConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ClusterConfiguration)

Etcd contains elements describing Etcd configuration.

Etcd 包含描述 Etcd 配置的元素。

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `local` **[Required] [需要]**  [`LocalEtcd`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-LocalEtcd) | `local` provides configuration knobs for configuring the local etcd instance. `local` and `external` are mutually exclusive. “ local”提供配置旋钮，用于配置本地 etcd 实例。“ local”和“ external”是互斥的 |
| `external` **[Required] [需要]**  [`ExternalEtcd`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ExternalEtcd) | `external` describes how to connect to an external etcd cluster. `local` and `external` are mutually exclusive. ‘ external’描述了如何连接到外部的 etcd 集群。‘ local’和‘ external’是互斥的 |

## `ExternalEtcd`    

**Appears in:**

出现在:

- [Etcd](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-Etcd)

ExternalEtcd describes an external etcd cluster. Kubeadm has no knowledge of where certificate files live and they must be supplied.

ExternalEtcd 描述了一个外部的 etcd 集群。

| Field 田野调查                                | Description 描述                                             |
| --------------------------------------------- | ------------------------------------------------------------ |
| `endpoints` **[Required] [需要]**  `[]string` | `endpoints` are endpoints of etcd members. This field is required. “端点”是 etcd 成员的端点。这个字段是必需的 |
| `caFile` **[Required] [需要]**  `string`      | `caFile` is an SSL Certificate Authority file used to secure etcd communication. Required if using a TLS connection. 是一个 SSL 证书授权文件，用于保护 etcd 通信。如果使用 TLS 连接，必须使用该文件 |
| `certFile` **[Required] [需要]**  `string`    | `certFile` is an SSL certification file used to secure etcd communication. Required if using a TLS connection. ‘ certFile’是一个 SSL 认证文件，用于保护 etcd 通信。如果使用 TLS 连接，则必须使用该文件 |
| `keyFile` **[Required] [需要]**  `string`     | `keyFile` is an SSL key file used to secure etcd communication. Required if using a TLS connection. “ keyFile”是一个 SSL 密钥文件，用于保护 etcd 通信。如果使用 TLS 连接，则必须使用该文件 |

## `FileDiscovery`    

**Appears in:**

出现在:

- [Discovery 发现](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-Discovery)

FileDiscovery is used to specify a file or URL to a kubeconfig file from which to load cluster information

FileDiscovery 用于指定一个文件或指向一个 kubeconfig 文件的 URL，从该文件加载集群信息

| Field 田野调查                                   | Description 描述                                             |
| ------------------------------------------------ | ------------------------------------------------------------ |
| `kubeConfigPath` **[Required] [需要]**  `string` | `kubeConfigPath` specifies the actual file path or URL to the kubeconfig file from which to load cluster information ‘ kubeConfigPath’指定要从中加载集群信息的 kubeconfig 文件的实际文件路径或 URL |

## `HostPathMount`    

**Appears in:**

出现在:

- [ControlPlaneComponent 控制行星组件](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ControlPlaneComponent)

HostPathMount contains elements describing volumes that are mounted from the host.

HostPathMount 包含描述从主机挂载的卷的元素。

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `name` **[Required] [需要]**  `string`                       | `name` is the volume name inside the Pod template. ‘ name’是 Pod 模板中的卷名 |
| `hostPath` **[Required] [需要]**  `string`                   | `hostPath` is the path in the host that will be mounted inside the Pod. “ hostPath”是主机中的路径，它将安装在吊舱内部 |
| `mountPath` **[Required] [需要]**  `string`                  | `mountPath` is the path inside the Pod where the `hostPath` volume is mounted. “ mountPath”是吊舱内安装“ hostPath”卷的路径 |
| `readOnly` **[Required] [需要]**  `bool`                     | `readOnly` controls write access to the volume. “ readOnly”控制对卷的写访问权限 |
| `pathType` **[Required] [需要]**  [`core/v1.HostPathType`](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.21/#hostpathtype-v1-core) | `pathType` is the type of the `hostPath` volume. ‘ pathType’是‘ hostPath’卷的类型 |

## `ImageMeta`    

**Appears in:**

出现在:

- [DNS](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-DNS)
- [LocalEtcd](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-LocalEtcd)

ImageMeta allows to customize the image used for components that are not originated from the Kubernetes/Kubernetes release process

Imagemageta 允许定制组件使用的图像，这些组件不是来自 Kubernetes/Kubernetes 发布过程

| Field 田野调查                                    | Description 描述                                             |
| ------------------------------------------------- | ------------------------------------------------------------ |
| `imageRepository` **[Required] [需要]**  `string` | `imageRepository` sets the container registry to pull images from. If not set, the ImageRepository defined in ClusterConfiguration will be used instead. 将容器注册表设置为从容器中提取图像。如果没有设置，那么将使用 ClusterConfiguration 中定义的 imageerepositor |
| `imageTag` **[Required] [需要]**  `string`        | `imageTag` allows to specify a tag for the image. In case this value is set, kubeadm does not change automatically the version of the above components during upgrades. ‘ imageTag’允许为图像指定标记。在设置此值的情况下，kubeadm 不会在升级期间自动更改上述组件的版本 |

## `JoinControlPlane`    

**Appears in:**

出现在:

- [JoinConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-JoinConfiguration)

JoinControlPlane contains elements describing an additional control plane instance to be deployed on the joining node.

JoinControlPlane 包含描述要部署在连接节点上的附加控制平面实例的元素。

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `localAPIEndpoint` **[Required] [需要]**  [`APIEndpoint`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-APIEndpoint) | `localAPIEndpoint` represents the endpoint of the API server instance to be deployed on this node. “ localAPIEndpoint”表示要部署到此节点上的 API 服务器实例的端点 |
| `certificateKey` **[Required] [需要]**  `string`             | `certificateKey` is the key that is used for decryption of certificates after they are downloaded from the secret upon joining a new control plane node. The corresponding encryption key is in the InitConfiguration. “认证密钥”是证书加入新的控制平面节点后从秘密中下载后用于解密的密钥。相应的加密密钥位于 InitConfiguration 中 |

## `LocalEtcd`    

**Appears in:**

出现在:

- [Etcd](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-Etcd)

LocalEtcd describes that kubeadm should run an etcd cluster locally

LocalEtcd 描述了 kubeadm 应该在本地运行 etcd 集群

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `ImageMeta` **[Required] [需要]**  [`ImageMeta`](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ImageMeta) | (Members of  (委员会成员`ImageMeta` are embedded into this type.)   `ImageMeta` allows to customize the container used for etcd. 可以自定义用于 etcd 的容器 |
| `dataDir` **[Required] [需要]**  `string`                    | `dataDir` is the directory etcd will place its data. Defaults to "/var/lib/etcd". ‘ dataDir’是 etcd 将放置其数据的目录。默认值为“/var/lib/etcd” |
| `extraArgs` **[Required] [需要]**  `map[string]string`       | `extraArgs` are extra arguments provided to the etcd binary when run inside a static pod. 是在静态 pod 中运行时提供给 etcd 二进制文件的额外参数 |
| `serverCertSANs` **[Required] [需要]**  `[]string`           | `serverCertSANs` sets extra Subject Alternative Names for the etcd server signing cert. “ serverCertSANs”为 etcd 服务器签名证书设置了额外的主题替代名称 |
| `peerCertSANs` **[Required] [需要]**  `[]string`             | `peerCertSANs` sets extra Subject Alternative Names for the etcd peer signing cert. “ peerCertSANs”为 etcd peer 签名证书设置了额外的主题替代名称 |

## `Networking`    

**Appears in:**

出现在:

- [ClusterConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-ClusterConfiguration)

Networking contains elements describing cluster's networking configuration

网络包含描述集群网络配置的元素

| Field 田野调查                                  | Description 描述                                             |
| ----------------------------------------------- | ------------------------------------------------------------ |
| `serviceSubnet` **[Required] [需要]**  `string` | `serviceSubnet` is the subnet used by k8s services. Defaults to "10.96.0.0/12". “ serviceSubnet”是 k8s 服务使用的子网，缺省值为“10.96.0.0/12” |
| `podSubnet` **[Required] [需要]**  `string`     | `podSubnet` is the subnet used by Pods. “ podSubnet”是 Pods 使用的子网 |
| `dnsDomain` **[Required] [需要]**  `string`     | `dnsDomain` is the DNS domain used by k8s services. Defaults to "cluster.local". 域名是 k8s 服务使用的 DNS 域名，默认为“ cluster.local” |

## `NodeRegistrationOptions`    

**Appears in:**

出现在:

- [InitConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-InitConfiguration)
- [JoinConfiguration](https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta2/#kubeadm-k8s-io-v1beta2-JoinConfiguration)

NodeRegistrationOptions  holds fields that relate to registering a new control-plane or node to  the cluster, either via "kubeadm init" or "kubeadm join"

NodeRegistrationOptions 包含与通过“ kubeadm init”或“ kubeadm join”向集群注册新控制平面或节点相关的字段

| Field 田野调查                                               | Description 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `name` **[Required] [需要]**  `string`                       | `name` is the `.metadata.name` field of the Node API object that will be created in this `kubeadm init` or `kubeadm join` operation. This field is also used in the CommonName field of the kubelet's client certificate to the API server. Defaults to the hostname of the node if not provided. |
| `criSocket` **[Required] [需要]**  `string`                  | `criSocket` is used to retrieve container runtime info. This information will be annotated to the Node API object, for later re-use. ‘ criSocket’用于检索集装箱运行时信息。这些信息将被注释到节点 API 对象中，以便以后重用 |
| `taints` **[Required] [需要]**  [`[\]core/v1.Taint`](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.21/#taint-v1-core) | `taints` specifies the taints the Node API object should be registered with. If this field is unset, i.e. nil, in the `kubeadm init` process, it will be defaulted to `['"node-role.kubernetes.io/master"=""']`. If you don't want to taint your control-plane node, set this field to an empty list, i.e. `taints: []` in the YAML file. This field is solely used for Node registration. |
| `kubeletExtraArgs` **[Required] [需要]**  `map[string]string` | `kubeletExtraArgs` passes through extra arguments to the kubelet. The arguments here are passed to the kubelet command line via the environment file kubeadm writes at runtime for the kubelet to source. This overrides the generic base-level configuration in the "kubelet-config-1.X" ConfigMap. Flags have higher priority when parsing. These values are local and specific to the node kubeadm is executing on. ‘ kubeletExtraArgs’将额外的参数传递给 kubelet。这里的参数通过 kubelet 在运行时写入的环境文件  kubelet 传递到 kubelet 命令行 source。这将覆盖“ kubelet-config-1.X”ConfigMap  中的通用基本级配置。标志在解析时具有更高的优先级。这些值是本地的，特定于正在执行的节点 kubeadm |
| `ignorePreflightErrors` **[Required] [需要]**  `[]string`    | `ignorePreflightErrors` provides a slice of pre-flight errors to be ignored when the current node is registered. ‘ ignorepreflightors’提供了一个在注册当前节点时可以忽略的飞行前错误片段 |

## 